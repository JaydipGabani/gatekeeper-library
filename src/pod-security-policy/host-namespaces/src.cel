variables:
- name: sharingNamespace
  expression: |
    has(variables.anyObject.spec.hostPID) || has(variables.anyObject.spec.hostIPC) ? variables.anyObject.spec.hostPID || variables.anyObject.spec.hostIPC : false
validations:
- expression: '(has(request.operation) && request.operation == "UPDATE") || !variables.sharingNamespace'
  messageExpression: '"Sharing the host namespace is not allowed: " + variables.anyObject.metadata.namespace'